{% extends "base.html" %} {% block title %}Shopping Points Optimiser{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/choices.min.css') }}" />
{% endblock %} {% block content %}
<div class="card medium">
  <h1>ğŸ’° Shopping Points Optimiser</h1>

  <form method="post" action="/evaluate">
    <div class="form-group">
      <label>ğŸ“Š Modus wÃ¤hlen:</label>
      <div class="mode-toggle">
        <button type="button" class="mode-btn active" data-mode="shopping" onclick="selectMode('shopping')">
          <span class="icon">ğŸ’³</span>
          <span>Einkaufs-Szenario (nach Betrag)</span>
        </button>
        <button type="button" class="mode-btn" data-mode="voucher" onclick="selectMode('voucher')">
          <span class="icon">ğŸ</span>
          <span>Gutschein erzeugen (benÃ¶tigter Umsatz)</span>
        </button>
        <button type="button" class="mode-btn" data-mode="contract" onclick="selectMode('contract')">
          <span class="icon">âœï¸</span>
          <span>Vertragsabschluss (einmalige Punkte)</span>
        </button>
      </div>
      <div style="display: none">
        <input type="radio" id="mode-shopping" name="mode" value="shopping" checked />
        <input type="radio" id="mode-voucher" name="mode" value="voucher" />
        <input type="radio" id="mode-contract" name="mode" value="contract" />
      </div>
    </div>

    <div id="shop-warning" class="warning" style="display: none">
      âš ï¸ Dieser Shop unterstÃ¼tzt diesen Modus nicht. Bitte wÃ¤hlen Sie einen anderen Modus oder Shop.
    </div>

    <div class="form-group">
      <label for="shop-select">ğŸª Shop wÃ¤hlen:</label>
      <select name="shop" id="shop-select" required>
        <option value="">-- Shop auswÃ¤hlen --</option>
        <!-- Optionen werden dynamisch per JS geladen -->
      </select>
    </div>

    <div id="shopping-fields" class="input-fields" style="display: block">
      <label>ğŸ’µ Betrag:</label>
      <div class="input-group">
        <input type="number" step="0.01" name="amount" id="amount" placeholder="100.00" min="0" inputmode="decimal" />
        <span class="currency-symbol">â‚¬</span>
      </div>
    </div>

    <div id="voucher-fields" class="input-fields" style="display: none">
      <label>ğŸ« Gutschein-Betrag:</label>
      <div class="input-group">
        <input type="number" step="0.01" name="voucher" id="voucher" placeholder="50.00" min="0" inputmode="decimal" />
        <span class="currency-symbol">â‚¬</span>
      </div>
    </div>

    <div id="contract-fields" class="input-fields" style="display: none">
      <div class="contract-info">
        â„¹ï¸ Bei Abschluss eines Vertrages mit diesem Shop erhÃ¤ltst du einmalige Bonuspunkte pro Programm. Klicke
        "Berechnen" um die Gegenwerte zu sehen.
      </div>
    </div>

    <button type="submit" id="submit-btn">ğŸ” Berechnen</button>
  </form>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/choices.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/index.js') }}"></script>
<script>
  // Shopdaten werden dynamisch per AJAX geladen

  function selectMode(mode) {
    const radio = document.getElementById(`mode-${mode}`);
    if (radio) {
      radio.checked = true;
    }
    document.querySelectorAll(".mode-btn").forEach((btn) => {
      btn.classList.toggle("active", btn.dataset.mode === mode);
    });
    updateUI();
  }

  // Die gesamte Shop-Logik wird jetzt in static/js/index.js gehandhabt
</script>
{% endblock %}
