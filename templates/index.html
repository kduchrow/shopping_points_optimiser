{% extends "base.html" %} {% block title %}Shopping Points Optimiser{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/choices.min.css') }}" />
{% endblock %} {% block content %}
<!-- Info Section - Top Card -->
<div class="card wide" style="margin-bottom: 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
  <h2 style="margin-top: 0; color: white;">ğŸ¯ Was ist Shopping Points Optimiser?</h2>
  <p style="color: rgba(255,255,255,0.95); font-size: 1.05em; line-height: 1.6; margin: 0;">
    Ein <strong>von der Community getragenes Tool</strong>, das dir zeigt, wie viel Cashback und Bonuspunkte du bei deinem nÃ¤chsten Online-Einkauf verdienen kannst.
    Vergleiche alle verfÃ¼gbaren LoyalitÃ¤tsprogramme fÃ¼r deinen Shop und maximiere deine Belohnungen.
  </p>
  <p style="color: rgba(255,255,255,0.9); margin-top: 12px; margin-bottom: 0;">
    âœ¨ <strong>Kostenlos, datenschutzfreundlich & ohne versteckte GebÃ¼hren</strong>
  </p>

  <!-- Platform Statistics -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-top: 20px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,0.2);">
    <div style="text-align: center;">
      <div style="font-size: 2em; font-weight: bold; color: white;">{{ num_programs }}</div>
      <div style="font-size: 0.9em; color: rgba(255,255,255,0.85);">Bonusprogramme</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 2em; font-weight: bold; color: white;">{{ num_shops }}</div>
      <div style="font-size: 0.9em; color: rgba(255,255,255,0.85);">Shops</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 2em; font-weight: bold; color: white;">{{ num_rates }}</div>
      <div style="font-size: 0.9em; color: rgba(255,255,255,0.85);">Raten erfasst</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 2em; font-weight: bold; color: white;">{{ num_proposals }}</div>
      <div style="font-size: 0.9em; color: rgba(255,255,255,0.85);">Community-BeitrÃ¤ge</div>
    </div>
    {% if last_update_text %}
    <div style="text-align: center;">
      <div style="font-size: 2em; font-weight: bold; color: white;">{{ last_update_text }}</div>
      <div style="font-size: 0.9em; color: rgba(255,255,255,0.85);">Letzte Aktualisierung</div>
    </div>
    {% endif %}
  </div>
</div>

<!-- Form Card -->
<div class="card medium" style="margin-bottom: 24px;">
  <h1>ğŸ’° Shopping Points Optimiser</h1>

  {% set can_view_rates = current_user.is_authenticated and current_user.role in ['moderator', 'admin'] %}
  <form method="post" action="/evaluate">
    <input type="hidden" name="mode" value="shopping" />

    <div class="form-group">
      <label for="shop-select">ğŸª Shop wÃ¤hlen:</label>
      <select name="shop" id="shop-select" required>
        <option value="">-- Shop auswÃ¤hlen --</option>
        <!-- Optionen werden dynamisch per JS geladen -->
      </select>
    </div>

    {% if can_view_rates %}
    <div id="shopping-fields" class="input-fields" style="display: block">
      <label for="amount">ğŸ’µ Betrag (optional):</label>
      <p class="text-small text-gray" style="margin: 6px 0 10px 0;">
        Leer lassen, um nur die aktuellen Rateninformationen ohne Berechnung zu sehen.
      </p>
      <div class="input-group">
        <input type="number" step="0.01" name="amount" id="amount" placeholder="100.00" min="0" inputmode="decimal" />
        <span class="currency-symbol">â‚¬</span>
      </div>
    </div>
    {% else %}
    <div class="info-box" style="margin-top: 12px;">
      Genaue Raten koennen wir aus rechtlichen Gruenden leider nicht anzeigen.
    </div>
    {% endif %}

    {% if current_user.is_authenticated %}
    <div class="form-group" style="margin-top: 12px;">
      <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
        <input type="checkbox" name="include_my_proposals" value="on" checked style="width:18px; height:18px;">
        <span>Meine VorschlÃ¤ge im Ergebnis anzeigen (nur fÃ¼r mich sichtbar)</span>
      </label>
    </div>
    <div class="form-group" style="margin-top: 12px;">
      <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
        <input type="checkbox" name="favorites_only" value="on" id="favorites-only-checkbox" style="width:18px; height:18px;" {% if has_favorites %}checked{% endif %}>
        <span>â­ Nur meine favorisierten Bonusprogramme anzeigen</span>
      </label>
      <p class="text-small text-gray" style="margin: 6px 0 0 28px;">
        Du kannst deine Favoriten im <a href="/profile" style="color: var(--brand-primary);">Profil</a> verwalten.
      </p>
    </div>
    {% endif %}

    {% if can_view_rates %}
    <button type="submit" id="submit-btn">â„¹ï¸ Informationen ohne Wert anzeigen</button>
    {% else %}
    <button type="submit" id="submit-btn">Programme anzeigen</button>
    {% endif %}
  </form>
</div>

<!-- How it works Section -->
<div class="card wide" style="margin-bottom: 24px;">
  <h2 style="margin-top: 0;">ğŸš€ Wie funktioniert's?</h2>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
    <!-- Step 1 -->
    <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #3b82f6;">
      <h3 style="margin: 0 0 8px 0; color: #1f2937;">1ï¸âƒ£ Shop wÃ¤hlen</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">WÃ¤hle den Online-Shop aus, bei dem du kaufen mÃ¶chtest</p>
    </div>

    <!-- Step 2 -->
    <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
      <h3 style="margin: 0 0 8px 0; color: #1f2937;">2ï¸âƒ£ Betrag eingeben (optional)</h3>
      {% if can_view_rates %}
      <p style="color: #666; margin: 0; font-size: 0.95em;">Gib einen Betrag ein oder lass das Feld leer um nur die Raten zu sehen</p>
      {% else %}
      <p style="color: #666; margin: 0; font-size: 0.95em;">Raten sind aus rechtlichen GrÃ¼nden leider nicht verfÃ¼gbar</p>
      {% endif %}
    </div>

    <!-- Step 3 -->
    <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #ec4899;">
      <h3 style="margin: 0 0 8px 0; color: #1f2937;">3ï¸âƒ£ Ergebnisse vergleichen</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">Sehe alle verfÃ¼gbaren Bonusprogramme und deren geschÃ¤tzten Wert</p>
    </div>
  </div>

  <div style="margin-top: 20px; padding: 16px; background: #ecf0ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
    {% if can_view_rates %}
    <strong>ğŸ’¡ Tipp:</strong> Du brauchst keinen Betrag einzugeben um die aktuellen Raten zu sehen. Lass das Feld einfach leer und klicke auf "Informationen ohne Wert anzeigen"!
    {% else %}
    <strong>ğŸ’¡ Tipp:</strong> Programmbeziehungen sind sichtbar, konkrete Raten sind aus rechtlichen GrÃ¼nden leider nicht verfÃ¼gbar.
    {% endif %}
  </div>
</div>

<!-- Community Section -->
<div class="card wide" style="margin-bottom: 24px; background: #fef3c7; border: 2px solid #f59e0b;">
  <h2 style="margin-top: 0; color: #92400e;">ğŸ‘¥ Community-getriebenes Projekt</h2>
  <p style="color: #78350f; margin: 0;">
    Shopping Points Optimiser lebt von deiner Mitwirkung! Wenn du <strong>fehlerhafte Daten, fehlende Shops oder veraltete Raten</strong> entdeckst,
    kannst du ganz einfach einen Vorschlag einreichen. Unsere Community und Administratoren prÃ¼fen diese regelmÃ¤ÃŸig.
  </p>
  <p style="color: #78350f; margin-top: 12px; margin-bottom: 0;">
    <strong>Du findest einen Fehler?</strong> Nach dem Vergleich auf der Ergebnisseite kannst du unter <em>"âœï¸ Vorschlag einreichen"</em> Verbesserungen vorschlagen!
  </p>
</div>

<!-- FAQ Section -->
<div class="card wide">
  <h2 style="margin-top: 0;">â“ HÃ¤ufig gestellte Fragen</h2>
  <div style="display: grid; gap: 16px;">
    <div>
      <h3 style="margin: 0 0 6px 0; color: #1f2937; font-size: 1em;">ğŸ’¾ Werden meine Daten gespeichert?</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">Nein. Wir speichern keine Suchverlauf oder Kaufdaten. Jede Suche ist vÃ¶llig anonym.</p>
    </div>
    <div>
      <h3 style="margin: 0 0 6px 0; color: #1f2937; font-size: 1em;">ğŸ“Š Warum unterscheiden sich die Raten zwischen Programmen?</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">Jedes LoyalitÃ¤tsprogramm verhandelt Raten direkt mit den HÃ¤ndlern. Manche spezialisieren sich auf Cashback, andere auf Punkte.</p>
    </div>
    <div>
      <h3 style="margin: 0 0 6px 0; color: #1f2937; font-size: 1em;">ğŸ”„ Wie oft werden die Raten aktualisiert?</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">Raten werden regelmÃ¤ÃŸig durch automatisierte Scraper aktualisiert, um die neuesten Angebote widerzuspiegeln.</p>
    </div>
    <div>
      <h3 style="margin: 0 0 6px 0; color: #1f2937; font-size: 1em;">â• Kann ich mehrere Programme kombinieren?</h3>
      <p style="color: #666; margin: 0; font-size: 0.95em;">Das hÃ¤ngt vom HÃ¤ndler ab. Manche ermÃ¶glichen die Kombination von Multiplikatoren und Rabatten. Siehe die Sonderaktionen fÃ¼r Details.</p>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/choices.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/index.js') }}"></script>
<script>
  // Shopdaten werden dynamisch per AJAX geladen (siehe static/js/index.js)
</script>
{% endblock %}
