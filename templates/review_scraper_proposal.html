{% extends "base.html" %} {% block title %}Vorschlag reviewen - Shopping Points
Optimiser{% endblock %} {% block nav %}
<nav class="top-nav">
  <a class="nav-link" href="/proposals">üìù Beitr√§ge</a>
</nav>
{% endblock %} {% block content %}
<div class="card narrow">
  <h1>ü§ñ Scraper-Vorschlag reviewen</h1>

  <!-- Original Proposal Info -->
  <div class="info-box">
    <p>
      <strong>Vorschlagstyp:</strong>
      {% if proposal.proposal_type == 'rate_change' %} Tarif√§nderung {% elif
      proposal.proposal_type == 'shop_add' %} Neuer Shop {% elif
      proposal.proposal_type == 'program_add' %} Neues Bonusprogramm {% elif
      proposal.proposal_type == 'coupon_add' %} Neuer Coupon/Aktion {% endif %}
      <span class="proposal-type">ü§ñ Scraper erstellt</span>
    </p>

    {% if proposal.shop %}
    <p><strong>Shop:</strong> {{ proposal.shop.name }}</p>
    {% endif %} {% if proposal.program %}
    <p><strong>Bonusprogramm:</strong> {{ proposal.program.name }}</p>
    {% endif %} {% if proposal.reason %}
    <p><strong>Notiz:</strong> {{ proposal.reason }}</p>
    {% endif %} {% if proposal.source_url %}
    <p>
      <strong>Quelle:</strong>
      <a href="{{ proposal.source_url }}" target="_blank"
        >{{ proposal.source_url[:50] }}...</a
      >
    </p>
    {% endif %}
  </div>

  <form method="post">
    <!-- Rate Change Form -->
    {% if proposal.proposal_type == 'rate_change' %}
    <div class="form-group">
      <label for="points_per_eur">Punkte pro EUR</label>
      <input
        type="number"
        id="points_per_eur"
        name="points_per_eur"
        step="0.01"
        value="{{ proposal.proposed_points_per_eur or '' }}"
        required
      />
      <p style="font-size: 12px; color: #6b7280; margin-top: 4px">
        Geben Sie die Punkte pro Euro ein oder akzeptieren Sie den Wert des
        Scrapers
      </p>
    </div>

    <div class="form-group">
      <label for="cashback_pct">Cashback %</label>
      <input
        type="number"
        id="cashback_pct"
        name="cashback_pct"
        step="0.01"
        value="{{ proposal.proposed_cashback_pct or 0 }}"
        min="0"
        max="100"
      />
    </div>

    <!-- Shop Add Form -->
    {% elif proposal.proposal_type == 'shop_add' %}
    <div class="form-group">
      <label for="name">Shop Name</label>
      <input
        type="text"
        id="name"
        name="name"
        value="{{ proposal.proposed_name or '' }}"
        required
      />
    </div>

    <!-- Program Add Form -->
    {% elif proposal.proposal_type == 'program_add' %}
    <div class="form-group">
      <label for="name">Programmname</label>
      <input
        type="text"
        id="name"
        name="name"
        value="{{ proposal.proposed_name or '' }}"
        required
      />
    </div>

    <div class="form-group">
      <label for="point_value_eur">Punktwert (EUR)</label>
      <input
        type="number"
        id="point_value_eur"
        name="point_value_eur"
        step="0.0001"
        value="{{ proposal.proposed_point_value_eur or '' }}"
        required
      />
    </div>

    <!-- Coupon Add Form -->
    {% elif proposal.proposal_type == 'coupon_add' %}
    <div class="form-group">
      <label for="coupon_type">Coupon Typ</label>
      <select id="coupon_type" name="coupon_type" required>
        <option
          value="multiplier"
          {%
          if
          proposal.proposed_coupon_type=""
          ="multiplier"
          %}selected{%
          endif
          %}
        >
          Multiplikator
        </option>
        <option
          value="discount"
          {%
          if
          proposal.proposed_coupon_type=""
          ="discount"
          %}selected{%
          endif
          %}
        >
          Rabatt
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="coupon_value">Wert</label>
      <input
        type="number"
        id="coupon_value"
        name="coupon_value"
        step="0.01"
        value="{{ proposal.proposed_coupon_value or '' }}"
        required
      />
      <p style="font-size: 12px; color: #6b7280; margin-top: 4px">
        z.B. 2 f√ºr 2x Multiplikator oder 10 f√ºr 10% Rabatt
      </p>
    </div>

    <div class="form-group">
      <label for="coupon_description">Beschreibung</label>
      <textarea id="coupon_description" name="coupon_description">
{{ proposal.proposed_coupon_description or '' }}</textarea
      >
    </div>

    <div class="form-group">
      <div class="flex items-center gap-10">
        <input
          type="checkbox"
          id="coupon_combinable"
          name="coupon_combinable"
          {%
          if
          proposal.proposed_coupon_combinable
          %}checked{%
          endif
          %}
        />
        <label for="coupon_combinable" class="mb-0"
          >Mit anderen Coupons kombinierbar</label
        >
      </div>
    </div>

    <div class="form-group">
      <label for="coupon_valid_to">G√ºltig bis</label>
      <input
        type="datetime-local"
        id="coupon_valid_to"
        name="coupon_valid_to"
        value="{{ proposal.proposed_coupon_valid_to.isoformat() if proposal.proposed_coupon_valid_to else '' }}"
      />
    </div>
    {% endif %}

    <!-- Additional Notes -->
    <div class="form-group">
      <label for="reason">Ihre Notiz (optional)</label>
      <textarea
        id="reason"
        name="reason"
        placeholder="F√ºgen Sie weitere Informationen oder Korrektionen hinzu..."
      ></textarea>
    </div>

    <div class="flex gap-10 mt-25">
      <button type="submit" class="btn">‚úì Best√§tigen und einreichen</button>
      <a
        href="/proposals"
        class="btn btn-secondary text-decoration-none text-center"
        >‚¨Ö Zur√ºck</a
      >
    </div>
  </form>
</div>
{% endblock %}
